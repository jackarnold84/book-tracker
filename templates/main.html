<!DOCTYPE html>
<html>

<head>
    <title>Book Tracker</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="static/images/icon.png">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="static/style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="static/utils.js"></script>
</head>



<body>

    <!-- HEADER -->
    <div class="w3-container w3-black w3-padding">
        <div class="w3-center fit-width">
            <h1 class="w3-xxlarge">Book Tracker</h1>
        </div>
    </div>


    <!-- CONTENT -->
    <div class="w3-container fit-width">

        <p class="w3-center">Updated {{ last_update }}</p>

        <!-- Over Time Plots -->
        <br>
        <div class="w3-border" style="min-width: 500px;">

            <!-- plot tabs -->
            <div class="w3-bar w3-theme w3-center">
                <button id="bbal-btn" class="w3-bar-item w3-button tabbtn w3-padding-8" onclick="openPlot('bbal')">
                    Book Balance
                </button>
                <button id="nbal-btn" class="w3-bar-item w3-button tabbtn w3-padding-8" onclick="openPlot('nbal')">
                    Net Balance
                </button>
            </div>

            <!-- plots -->
            <div id="bbal-90" class="w3-container plot-tab w3-animate-opacity">
                {{ book_balance_plot | safe }}
            </div>

            <div id="bbal-all" class="w3-container plot-tab w3-animate-opacity">
                {{ book_balance_all_plot | safe }}
            </div>

            <div id="nbal-90" class="w3-container plot-tab w3-animate-opacity">
                {{ net_balance_plot | safe }}
            </div>

            <div id="nbal-all" class="w3-container plot-tab w3-animate-opacity">
                {{ net_balance_all_plot | safe }}
            </div>

            <!-- range tabs -->
            <div class="w3-bar w3-theme">
                <button id="90-btn" class="w3-bar-item w3-button tabbtn w3-padding-8" onclick="openRange('90')">
                    Last 90 Days
                </button>
                <button id="all-btn" class="w3-bar-item w3-button tabbtn w3-padding-8" onclick="openRange('all')">
                    All Time
                </button>
            </div>
        </div>
        <br><br>


        
        <!-- Book Balances -->
        <h3 class="w3-center">Book Balance</h3>
        <p class="w3-center">Total: {{ total_balance }}</p>
        <div class="w3-container fit-width" style="max-width: 800px;">
            {{ book_balance_bars | safe }}
        </div>


        <!-- Net Stats -->
        <h3 class="w3-center">Net Stats</h3>
        <div class="w3-container fit-width" style="max-width: 500px;">
            <table class="w3-table w3-border w3-bordered">
                <tbody>
                    {% for r in net_stats_table.iloc %}
                    <tr>
                        {% for x in r %}
                        <td>{{ x }}</td>
                        {% endfor %}
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <br><br>


        <!-- Last 90 Days -->
        <h3 class="w3-center">Last 90 Days</h3>
        <div class="w3-container fit-width" style="max-width: 500px;">
            <table class="w3-table w3-border w3-bordered">
                <tbody>
                    {% for r in last_90_days_table.iloc %}
                    <tr>
                        {% for x in r %}
                        <td>{{ x }}</td>
                        {% endfor %}
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <br><br>


        <!-- Monthly Earnings -->
        <h3 class="w3-center">Monthly Earnings</h3>
        <div class="w3-container fit-width" style="max-width: 800px;">
            {{ monthly_profit_bars | safe }}
        </div>


        <!-- Career Betting -->
        <h3 class="w3-center">Career Betting</h3>
        <div class="w3-container fit-width" style="max-width: 500px;">
            <table class="w3-table w3-border w3-bordered">
                <tbody>
                    {% for r in career_bets_table.iloc %}
                    <tr>
                        {% for x in r %}
                        <td>{{ x }}</td>
                        {% endfor %}
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <br>


    </div>


    <!-- FOOTER -->
    <footer class="w3-center w3-container w3-small w3-black" style="margin-top: 64px;">
        <p>(C) 2022 Jack Arnold</p>
    </footer>


</body>



<!-- SCRIPTS -->
<script>

    // Tab Control
    var currTab = 'bbal';
    var currRange = '90';

    var plotIDs = ['bbal-90', 'bbal-all', 'nbal-90', 'nbal-all']
    var btnIDs = ['bbal-btn', 'nbal-btn', '90-btn', 'all-btn']

    function openPlot(tabName) {
        plotIDs.forEach(id => {
            $(`#${id}`).hide()
        });

        btnIDs.forEach(id => {
            $(`#${id}`).removeClass('w3-dark-grey');
        });
        
        currTab = tabName;
        $(`#${currTab}-${currRange}`).show()
        $(`#${currTab}-btn`).addClass("w3-dark-grey");
        $(`#${currRange}-btn`).addClass("w3-dark-grey");
    }

    function openRange(rangeName) {
        plotIDs.forEach(id => {
            $(`#${id}`).hide()
        });

        btnIDs.forEach(id => {
            $(`#${id}`).removeClass('w3-dark-grey');
        });
        
        currRange = rangeName;
        $(`#${currTab}-${currRange}`).show()
        $(`#${currTab}-btn`).addClass("w3-dark-grey");
        $(`#${currRange}-btn`).addClass("w3-dark-grey");
    }

    openPlot(currTab);
    openRange(currRange);


</script>


</html>